rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*z*' = 'z value', '*p*' = 'Pr(>|z|)') %>%
mutate_if(is.character, str_replace_all,
c('environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)'))
table %>%
kable(caption = 'Summary of Logistic Regression Model on Resumption Rates',
digits = c(2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: Resumption ~ Environment * Group + (1 + Environment | Participant) + (1 | Item). Reference level: Short + ENS. Estimate unit: logit. Intercept: grand mean.',
footnote_as_chunk = TRUE)
pairs <- pairs(emmeans(model, ~ environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table %>%
kable(caption = 'Pairwise Comparisons for Logistic Regression Model on Resumption Rates',
digits = c(2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 18 tests.',
footnote_as_chunk = TRUE)
model <- read_rds('models/ept_orc_resumption_type_glmmtmb_model2.rds')
md <- read_rds('models/ept_orc_resumptoin_type_glmmtmb_data.rds')
table <- summary(model)$coefficients$cond %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', 'z' = 'z value', 'p' = 'Pr(>|z|)') %>%
mutate_at(vars('p'), round, 3) %>%
mutate_at(vars('Estimate', 'SE', 'z'), round, 2) %>%
mutate_if(is.character, str_replace_all,
c('subtype2' = 'Subtype(Full NP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)')) %>%
rename('*p*' = 'p', '*z*' = 'z')
table %>%
kable(caption = 'Summary of Negative Binomial Regression Model on Resumption Subtypes',
escape = FALSE,
digits = c(2, 2, 2, 2, 3)) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: Count ~ Subtype * Environment * Group + (1 + Environment | Participant). Reference level: Pronoun + Long + ENS. Estimate unit: log count. Intercept: grand mean.',
footnote_as_chunk = TRUE)
pairs <- pairs(emmeans(model, ~ subtype * environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*t*' = 't.ratio',
'Environment' = 'environment', 'Group' = 'group', 'Subtype' = 'subtype',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island',
'pronoun' = 'Pronoun', 'fullNP' = 'Full NP'))
table %>%
kable(caption = 'Pairwise Comparisons for Binomial Regression Model on Resumption Subtypes',
digits = c(2, 2, 2, 2, 2, 2, 2, 2, 3)) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
remove_column(7) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 24 tests.',
footnote_as_chunk = TRUE)
model <- read_rds('models/ept_coverage_glmer_model1.rds')
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*z*' = 'z value', '*p*' = 'Pr(>|z|)') %>%
mutate_if(is.character, str_replace_all,
c('environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)'))
check <- table %>%
mutate(OR = round(exp(abs(Estimate)), 2))
table %>%
kable(caption = 'Summary of Logistic Regression Model on Resumption Use',
digits = c(2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: Use ~ Environment * Group + (1 | Participant). Reference level: Short + ENS. Estimate unit: logit. Intercept: grand mean.',
footnote_as_chunk = TRUE)
pairs <- pairs(emmeans(model, ~ environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
check <- table %>%
mutate(OR = round(exp(abs(Estimate)), 2))
table %>%
kable(caption = 'Pairwise Comparisons for Logistic Regression Model on Resumption Use',
digits = c(2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 18 tests.',
footnote_as_chunk = TRUE)
model <- read_rds('models/spr_doall_rrt_region1_md6.rds')
table <- summary(model)$coefficients %>%
as.data.frame()
View(table)
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter')
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*t*' = 't value', '*p*' = 'Pr(>|t|)') %>%
mutate_if(is.character, str_replace_all,
c('dependency2' = 'Dependency(RP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)'))
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*t*' = 't value', '*p*' = 'Pr(>|t|)') %>%
mutate_if(is.character, str_replace_all,
c('dependency2' = 'Dependency(RP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)')) %>%
select(-df)
model <- read_rds('models/spr_doall_rrt_region1_md6.rds')
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*t*' = 't value', '*p*' = 'Pr(>|t|)') %>%
mutate_if(is.character, str_replace_all,
c('dependency2' = 'Dependency(RP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)')) %>%
select(-df)
table %>%
kable(caption = 'Summary of Linear Regression Model for RRTs at Region 1',
digits = c(2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: RRT ~ Dependency * Environment * Group + (1 + Dependency | Participant) + (1 + Dependency + Group | Item). Reference level: Gap + Short + ENS. Estimate unit: RRT. Intercept: grand mean.',
footnote_as_chunk = TRUE)
model <- read_rds('models/spr_doall_rrt_region1_md6.rds')
pairs <- pairs(emmeans(model, ~ dependency * environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table %>%
kable(caption = 'Pairwise Comparisons for Linear Regression Model for RRTs at Region 1',
digits = c(2, 2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 45 tests.',
footnote_as_chunk = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table %>%
kable(caption = 'Pairwise Comparisons for Linear Regression Model for RRTs at Region 1',
digits = c(2, 2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 45 tests.',
footnote_as_chunk = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
pairs <- pairs(emmeans(model, ~ dependency * environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table %>%
kable(caption = 'Pairwise Comparisons for Linear Regression Model for RRTs at Region 1',
digits = c(2, 2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 45 tests.',
footnote_as_chunk = TRUE)
model <- read_rds('models/spr_doall_rrt_region1_md6.rds')
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*t*' = 't value', '*p*' = 'Pr(>|t|)') %>%
mutate_if(is.character, str_replace_all,
c('dependency2' = 'Dependency(RP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)')) %>%
select(-df)
table %>%
kable(caption = 'Summary of Linear Regression Model for RRTs at Region 1',
digits = c(2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: RRT ~ Dependency * Environment * Group + (1 + Dependency | Participant) + (1 + Dependency + Group | Item). Reference level: Gap + Short + ENS. Estimate unit: RRT. Intercept: grand mean.',
footnote_as_chunk = TRUE)
pairs <- pairs(emmeans(model, ~ dependency * environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
ggplot(plot, aes(x = environment, y = the.emmean, group = dependency, col = dependency, shape = dependency)) +
geom_hline(yintercept = 0) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0, lwd = 5, alpha = .5, position = position_dodge(width = .4)) +
geom_errorbar(aes(ymin = case_when(is.na(lcmpl)~the.emmean, TRUE ~ lcmpl), ymax = case_when(is.na(rcmpl)~the.emmean, TRUE ~ rcmpl)), width = 0, lwd = 1, position = position_dodge(width = .4)) +
geom_line(lwd = 1, position = position_dodge(width = .4)) +
geom_point(size = 3, position = position_dodge(width = .4)) +
theme_classic() +
scale_y_continuous(name="RRT (ms)", breaks = seq(-100, 75, by = 25), limits = c(-110, 85)) +
scale_colour_manual(name="dependency", values=c('#648fff', '#ffb000'), labels=c("gap", "resumption")) +
scale_shape_manual(name="dependency", values=c(16, 15), labels=c("gap", "resumption")) +
theme(text = element_text(size = 12),
legend.margin=margin(0, 0, 0, -5)) +
facet_wrap(~group, labeller = as_labeller(c(`english` = 'ENS', `korean` = 'KLE', `mandarin` = 'MLE')))
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
ggplot(plot, aes(x = environment, y = the.emmean, group = dependency, col = dependency, shape = dependency)) +
geom_hline(yintercept = 0) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0, lwd = 5, alpha = .5, position = position_dodge(width = .4)) +
geom_errorbar(aes(ymin = case_when(is.na(lcmpl)~the.emmean, TRUE ~ lcmpl), ymax = case_when(is.na(rcmpl)~the.emmean, TRUE ~ rcmpl)), width = 0, lwd = 1, position = position_dodge(width = .4)) +
geom_line(lwd = 1, position = position_dodge(width = .4)) +
geom_point(size = 3, position = position_dodge(width = .4)) +
theme_classic() +
scale_y_continuous(name="RRT (ms)", breaks = seq(-100, 75, by = 25), limits = c(-110, 85)) +
scale_colour_manual(name="dependency", values=c('#648fff', '#ffb000'), labels=c("gap", "resumption")) +
scale_shape_manual(name="dependency", values=c(16, 15), labels=c("gap", "resumption")) +
theme(text = element_text(size = 12),
legend.margin=margin(0, 0, 0, -5)) +
facet_wrap(~group, labeller = as_labeller(c(`english` = 'ENS', `korean` = 'KLE', `mandarin` = 'MLE')))
# ggsave("plots/orc/spr_rrt_region1_emmeans.png", width=6.5, height=2, dpi=600)
spr <- df %>%
filter(task == 'sprt') %>%
arrange(study, group, participant) %>%
select_if(function(x){!all(is.na(x))})
ds <- spr %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(rt = as.numeric(as.character(rt)),
participant = as.factor(participant))
ds <- ds %>%
mutate(participant = fct_drop(participant))
trim <- ds %>%
filter(rt <= 3000) %>%
filter(rt >= 200) %>%
group_by(study, group, condition, region) %>%
mutate(sd2 = mean(rt, na.rm=T) + (2 * (sd(rt, na.rm=T)))) %>%
ungroup() %>%
mutate(rt = case_when(rt > sd2 ~ sd2, TRUE ~ as.numeric(rt))) %>%
select(-sd2) %>%
group_by(study, group, participant) %>%
mutate(acc_rate = mean(as.logical(accuracy))) %>%
ungroup()
trim <- trim %>%
filter(acc_rate > .5)
spr_crit <- spr %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(rt = as.numeric(as.character(rt)),
participant = as.factor(participant)) %>%
mutate(participant = fct_drop(participant))
spr_trim <- spr_crit %>%
filter(rt <= 3000) %>%
filter(rt >= 200)
spr_trim <- spr_trim %>%
mutate(region = as.numeric(region)) %>%
mutate(region2 = case_when(study == '210510_do' ~ region - 11,
study == '210510_su' & environment %in% c('short', 'long') ~ region - 8,
study == '210510_su' & environment == 'island' ~ region - 10))
spr_trim <- spr_trim %>%
mutate(stimulus = str_trim(tolower(stimulus))) %>%
mutate(length = nchar(stimulus))
class(spr_trim$length)
class(spr_trim$region)
spr_trim <- spr_trim %>%
mutate(region = as.factor(region))
spr_trim_orc <- spr_trim %>%
filter(study == '210510_do')
mod_spr_rrt_orc <- lmer(rt ~ length + region + (1 | participant), data = spr_trim_orc)
spr_trim_orc <- spr_trim_orc %>%
mutate(rrt = residuals(mod_spr_rrt_orc))
spr_trim_src <- spr_trim %>%
filter(study == '210510_su')
mod_spr_rrt_src <- lmer(rt ~ length + region + (1 | participant), data = spr_trim_src)
spr_trim_src <- spr_trim_src %>%
mutate(rrt = residuals(mod_spr_rrt_src))
spr_trim <- bind_rows(spr_trim_orc, spr_trim_src)
check <- spr_trim %>%
group_by(study, group, condition, region2) %>%
mutate(sd2 = mean(rrt, na.rm = T) + (2 * (sd(rrt, na.rm = T)))) %>%
ungroup() %>%
mutate(extreme = case_when(rrt > sd2 ~ TRUE, TRUE ~ FALSE)) %>%
select(-sd2) %>%
group_by(study) %>%
summarise(mean = mean(extreme, na.rm = TRUE) * 100) %>%
ungroup()
spr_trim <- spr_trim %>%
group_by(study, group, condition, region2) %>%
mutate(sd2 = mean(rrt, na.rm = T) + (2 * (sd(rrt, na.rm = T)))) %>%
ungroup() %>%
mutate(rrt = case_when(rrt > sd2 ~ sd2, TRUE ~ as.numeric(rrt))) %>%
select(-sd2)
spr_trim <- spr_trim %>%
group_by(study, group, participant) %>%
mutate(acc_rate = mean(as.logical(accuracy))) %>%
ungroup()
spr_trim <- spr_trim %>%
filter(acc_rate > .5)
md <- spr_crit_clean %>%
filter(region2 == 1,
study == '210510_do')
View(spr_crit)
md <- spr_crit_clean %>%
select(study, group, participant, item, dependency, environment, rrt)
spr_crit_clean <- read_csv('data/spr_crit_clean.csv')
md <- spr_crit_clean %>%
select(study, group, participant, item, dependency, environment, rrt)
md <- spr_crit_clean %>%
select(study, group, participant, item, dependency, environment, rrt)
md <- md %>%
mutate_at(c('study', 'group', 'participant', 'item', 'dependency', 'environment'), factor) %>%
mutate(rrt = as.numeric(rrt)) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'))
summary(md)
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$group) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
contrasts(md$group)
md %>% write_rds('data/spr_rrt_md.rds')
data <- read_rds('data/spr_rrt_md.rds')
spr_crit_clean <- read_csv('data/spr_crit_clean.csv')
View(spr_crit_clean)
md <- spr_crit_clean %>%
select(study, group, participant, item, region2, dependency, environment, rrt)
md <- md %>%
mutate_at(c('study', 'group', 'participant', 'item', 'region2', 'dependency', 'environment'), factor) %>%
mutate(rrt = as.numeric(rrt)) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'))
summary(md)
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$group) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
contrasts(md$group)
md %>% write_rds('data/spr_rrt_md.rds')
data <- read_rds('data/spr_rrt_md.rds')
check <- lme.dscore(model, data = filter(data, study == '210510_do', region2 == '1'), type = 'lme4')
library(EMAtools)
check <- lme.dscore(model, data = filter(data, study == '210510_do', region2 == '1'), type = 'lme4')
eff_size(pairs, sigma = sigma(model), edf = df.residual(model), method = 'identity')
model <- read_rds('models/spr_doall_rrt_region2_md9.rds')
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*t*' = 't value', '*p*' = 'Pr(>|t|)') %>%
mutate_if(is.character, str_replace_all,
c('dependency2' = 'Dependency(RP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)')) %>%
select(-df)
table %>%
kable(caption = 'Summary of Linear Regression Model for RRTs at Region 2',
digits = c(2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: RRT ~ Dependency * Environment * Group + (1 + Dependency * Environment | Participant) + (1 + Dependency + Group | Item). Reference level: Gap + Short + ENS. Estimate unit: millisecond. Intercept: grand mean.',
footnote_as_chunk = TRUE)
pairs <- pairs(emmeans(model, ~ dependency * environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table %>%
kable(caption = 'Pairwise Comparisons for Linear Regression Model for RRTs at Region 2',
digits = c(2, 2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 45 tests.',
footnote_as_chunk = TRUE)
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
ggplot(plot, aes(x = environment, y = the.emmean, group = dependency, col = dependency, shape = dependency)) +
geom_hline(yintercept = 0) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0, lwd = 5, alpha = .5, position = position_dodge(width = .4)) +
geom_errorbar(aes(ymin = case_when(is.na(lcmpl)~the.emmean, TRUE ~ lcmpl), ymax = case_when(is.na(rcmpl)~the.emmean, TRUE ~ rcmpl)), width = 0, lwd = 1, position = position_dodge(width = .4)) +
geom_line(lwd = 1, position = position_dodge(width = .4)) +
geom_point(size = 3, position = position_dodge(width = .4)) +
theme_classic() +
scale_y_continuous(name="RRT (ms)", breaks = seq(-100, 75, by = 25), limits = c(-110, 85)) +
scale_colour_manual(name="dependency", values=c('#648fff', '#ffb000'), labels=c("gap", "resumption")) +
scale_shape_manual(name="dependency", values=c(16, 15), labels=c("gap", "resumption")) +
theme(text = element_text(size = 12),
legend.margin=margin(0, 0, 0, -5)) +
facet_wrap(~group, labeller = as_labeller(c(`english` = 'ENS', `korean` = 'KLE', `mandarin` = 'MLE')))
model <- read_rds('models/spr_doall_rrt_region3_md6.rds')
table <- summary(model)$coefficients %>%
as.data.frame() %>%
rownames_to_column('Parameter') %>%
rename('SE' = 'Std. Error', '*t*' = 't value', '*p*' = 'Pr(>|t|)') %>%
mutate_if(is.character, str_replace_all,
c('dependency2' = 'Dependency(RP)',
'environment2' = 'Environment(Long)', 'environment3' = 'Environment(Island)',
'group2' = 'Group(KLE)', 'group3' = 'Group(MLE)')) %>%
select(-df)
table %>%
kable(caption = 'Summary of Linear Regression Model for RRTs at Region 3',
digits = c(2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = 'Model formula: RRT ~ Dependency * Environment * Group + (1 | Participant) + (1 + Group | Item). Reference level: Gap + Short + ENS. Estimate unit: millisecond. Intercept: grand mean.',
footnote_as_chunk = TRUE)
pairs <- pairs(emmeans(model, ~ dependency * environment * group), adjust = 'mvt', simple = 'each', combine = TRUE, reverse = TRUE)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table <- pairs %>%
as.data.frame() %>%
rename('*p*' = 'p.value', '*z*' = 'z.ratio',
'Dependency' = 'dependency', 'Environment' = 'environment', 'Group' = 'group',
'Contrast' = 'contrast', 'Estimate' = 'estimate') %>%
mutate_if(is.character, str_replace_all,
c('english' = 'ENS', 'korean' = 'KLE', 'mandarin' = 'MLE',
'gap' = 'Gap', 'pronoun' = 'RP',
'short' = 'Short', 'long' = 'Long', 'island' = 'Island')) %>%
select(-df)
table %>%
kable(caption = 'Pairwise Comparisons for Linear Regression Model for RRTs at Region 3',
digits = c(2, 2, 2, 2, 2, 2, 2, 3)
) %>%
kable_classic(bootstrap_options = c('condensed')) %>%
footnote(general = '*P*-value adjustment: multivariate *t* method for 45 tests.',
footnote_as_chunk = TRUE)
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
plot <- plot(emmeans(model, ~ dependency * environment * group), comparisons = TRUE, adjust = 'mvt', plotit = FALSE)
ggplot(plot, aes(x = environment, y = the.emmean, group = dependency, col = dependency, shape = dependency)) +
geom_hline(yintercept = 0) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0, lwd = 5, alpha = .5, position = position_dodge(width = .4)) +
geom_errorbar(aes(ymin = case_when(is.na(lcmpl)~the.emmean, TRUE ~ lcmpl), ymax = case_when(is.na(rcmpl)~the.emmean, TRUE ~ rcmpl)), width = 0, lwd = 1, position = position_dodge(width = .4)) +
geom_line(lwd = 1, position = position_dodge(width = .4)) +
geom_point(size = 3, position = position_dodge(width = .4)) +
theme_classic() +
scale_y_continuous(name="RRT (ms)", breaks = seq(-100, 75, by = 25), limits = c(-110, 85)) +
scale_colour_manual(name="dependency", values=c('#648fff', '#ffb000'), labels=c("gap", "resumption")) +
scale_shape_manual(name="dependency", values=c(16, 15), labels=c("gap", "resumption")) +
theme(text = element_text(size = 12),
legend.margin=margin(0, 0, 0, -5)) +
facet_wrap(~group, labeller = as_labeller(c(`english` = 'ENS', `korean` = 'KLE', `mandarin` = 'MLE')))
