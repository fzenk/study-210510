contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_dokoen_clmm_md1.rds')
summary(model1)
toc()
beep()
md <- temp %>%
filter(study == '210510_do',
group == 'mandarin',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_dozhen_clmm_md1.rds')
summary(model1)
toc()
beep()
md <- temp %>%
filter(study == '210510_do',
group == 'korean',
task == 'korean_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoko_clmm_md1.rds')
summary(model1)
toc()
beep()
md <- temp %>%
filter(study == '210510_do',
group == 'mandarin',
task == 'mandarin_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dozhzh_clmm_md1.rds')
summary(model1)
toc()
beep()
3246.32/60
5593.59
5593.59/60
library(tidyverse) # for data processing
library(lmerTest) # for mixed-effects modeling
library(readxl) # for reading .xlsx files
library(base64enc) # for converting recordings from base64 to audio files
library(stringdist) # for calculating edit distance on c-test responses
library(hunspell) # for spell checking of c-test responses
library(patchwork) # for plotting
library(jsonlite) # for unpacking json
library(beepr) # for notifications
library(tictoc) # for timing operations
library(ggh4x) # for plotting
library(emmeans) #  for post-hoc tests; see https://marissabarlaz.github.io/portfolio/contrastcoding/
library(performance) # for checking model performance
df <- read_csv('data/data.csv', col_types = cols(.default = 'c')) %>%
select(-audio_data)
ct <- read_csv('data/ctest_scored.csv', col_types = cols(.default = 'f', accuracy = 'l'))
ajt <- df %>%
filter(task %in% c('english_ajt', 'korean_ajt', 'mandarin_ajt')) %>%
arrange(study, group, participant) %>%
select_if(function(x){!all(is.na(x))})
check <- ajt %>%
group_by(study, group, task, participant) %>%
summarise() %>%
ungroup() %>%
group_by(study, group, task) %>%
summarise(n = n()) %>%
ungroup()
check <- ajt %>%
filter(!response %in% c(1, 2, 3, 4, 5, 6))
ajt <- ajt %>%
filter(is.na(response) == FALSE)
ajt <- ajt %>%
mutate(acceptance = case_when(response > 3.5 ~ TRUE,
response < 3.5 ~ FALSE))
ajt <- ajt %>%
mutate(response = as.numeric(response)) %>%
group_by(study, group, task, participant) %>%
mutate(zscore = (response - mean(response, na.rm=T)) / sd(response, na.rm = T)) %>%
ungroup()
check <- ajt %>%
mutate(condition = as.factor(condition))
summary(check$condition)
temp <- ajt %>%
filter(condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(accuracy = as.logical(accuracy)) %>%
group_by(study, group, task, participant) %>%
summarise(acc_rate = mean(accuracy, na.rm = T)) %>%
ungroup()
check <- temp %>%
group_by(study, group, task) %>%
summarise(n = n()) %>%
ungroup()
check <- temp %>%
filter(acc_rate <= .5)
ggplot(temp, aes(x=group, y=acc_rate, fill=group, label=participant)) +
geom_hline(yintercept=.5) +
geom_violin() +
geom_boxplot(width = .1, fill='white') +
theme_classic() +
scale_x_discrete(name="group",
limits = c('english', 'korean', 'mandarin'),
labels = c('ENS', 'KLE', 'MLE')) +
scale_y_continuous(name="accuracy rate",
limits=c(0, 1)) +
theme(text = element_text(size = 12),
plot.title = element_text(size = 12, hjust = .5),
legend.position = "hide") +
facet_wrap(~task)
ajt <- ajt %>%
left_join(temp, by = c('study', 'group', 'task', 'participant')) %>%
filter(acc_rate > .5)
plot <- ajt %>%
group_by(group, task, participant, acc_rate) %>%
summarise() %>%
ungroup()
ggplot(plot, aes(x=group, y=acc_rate, fill=group, label=participant)) +
geom_hline(yintercept=.5) +
geom_violin() +
geom_boxplot(width = .1, fill='white') +
theme_classic() +
scale_x_discrete(name="group",
limits = c('english', 'korean', 'mandarin'),
labels = c('ENS', 'KLE', 'MLE')) +
scale_y_continuous(name="accuracy rate",
limits=c(0, 1)) +
theme(text = element_text(size = 12),
plot.title = element_text(size = 12, hjust = .5),
legend.position = "hide") +
facet_wrap(~task)
check <- ajt %>%
group_by(study, task, group, participant) %>%
summarise() %>%
ungroup() %>%
group_by(study, task, group) %>%
summarise(n = n()) %>%
ungroup()
temp <- ajt %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'),
dependency = as.factor(dependency))
library(ordinal)
md <- temp %>%
filter(study == '210510_do',
group == 'english',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = as.factor(response, ordered = TRUE))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
md <- temp %>%
filter(study == '210510_do',
group == 'korean',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
model1 <- read_rds('models/ajt_dokoen_clmm_md1.rds')
View(check)
check <- md %>%
group_by(study, group, task, participant) %>%
summarise() %>%
ungroup()
tic()
model6 <- clmm(response ~ dependency * environment +
(1 | participant) +
(1 | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoen_clmm_md6.rds')
summary(model6)
toc()
beep()
tic()
model5 <- clmm(response ~ dependency * environment +
(1 dependency + environment| participant) +
(1 | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoen_clmm_md5.rds')
summary(model5)
toc()
beep()
tic()
model5 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoen_clmm_md5.rds')
summary(model5)
toc()
beep()
anova(model5, model6)
tic()
model3 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoen_clmm_md3.rds')
summary(model3)
toc()
beep()
tic()
model2 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency + environment | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoen_clmm_md2.rds')
summary(model2)
toc()
beep()
tic()
model4 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 + dependency + environment | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoen_clmm_md4.rds')
summary(model4)
toc()
beep()
anova(model4, model5)
model1 <- read_rds('models/ajt_doenen_clmm_md1.rds')
kbl(summary(model4)$coefficients, digits = c(2, 2, 2, 3))
library(kableExtra)
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3))
pw <- model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
pw
kbl(pw)
kbl(pw, digits = c(2, 2, 2, 3))
kbl(pw, digits = c(2, 2, 2, 3), remove_column('df'))
kbl(pw, digits = c(2, 2, 2, 3), remove_column(df))
kbl(pw, digits = c(2, 2, 2, 3), remove_column(,df))
kbl(pw, digits = c(2, 2, 2, 3), remove_column(pw, df))
kbl(pw, digits = c(2, 2, 2, 3), remove_column(pw, 'df'))
kbl(pw, digits = c(2, 2, 2, 3)) %>%
remove_column('df')
kbl(pw, digits = c(2, 2, 2, 3)) %>%
remove_column(6)
kbl(pw, digits = c(2, 2, 2, 3), padding = 10) %>%
remove_column(6)
kbl(pw, digits = c(2, 2, 2, 3), padding = 50) %>%
remove_column(6)
kbl(pw, digits = c(2, 2, 2, 3), padding = 100) %>%
remove_column(6)
pairwise <- model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
pairwise
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3))
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3))
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3))
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3),
col.names = c('1', '2', '3', '4', '5'))
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3),
col.names = c('1', '2', '3', '4'))
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3))
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
library(tidyverse) # for data processing
library(lmerTest) # for mixed-effects modeling
library(readxl) # for reading .xlsx files
library(base64enc) # for converting recordings from base64 to audio files
library(stringdist) # for calculating edit distance on c-test responses
library(hunspell) # for spell checking of c-test responses
library(patchwork) # for plotting
library(jsonlite) # for unpacking json
library(beepr) # for notifications
library(tictoc) # for timing operations
library(ggh4x) # for plotting
library(emmeans) #  for post-hoc tests
library(performance) # for checking model performance
library(kableExtra) # for tables
library(ordinal) # for clmm models
df <- read_csv('data/data.csv', col_types = cols(.default = 'c')) %>%
select(-audio_data)
ct <- read_csv('data/ctest_scored.csv', col_types = cols(.default = 'f', accuracy = 'l'))
temp <- ajt %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'),
dependency = as.factor(dependency))
ajt <- df %>%
filter(task %in% c('english_ajt', 'korean_ajt', 'mandarin_ajt')) %>%
arrange(study, group, participant) %>%
select_if(function(x){!all(is.na(x))})
check <- ajt %>%
group_by(study, group, task, participant) %>%
summarise() %>%
ungroup() %>%
group_by(study, group, task) %>%
summarise(n = n()) %>%
ungroup()
check <- ajt %>%
filter(!response %in% c(1, 2, 3, 4, 5, 6))
ajt <- ajt %>%
filter(is.na(response) == FALSE)
ajt <- ajt %>%
mutate(acceptance = case_when(response > 3.5 ~ TRUE,
response < 3.5 ~ FALSE))
ajt <- ajt %>%
mutate(response = as.numeric(response)) %>%
group_by(study, group, task, participant) %>%
mutate(zscore = (response - mean(response, na.rm=T)) / sd(response, na.rm = T)) %>%
ungroup()
check <- ajt %>%
mutate(condition = as.factor(condition))
summary(check$condition)
temp <- ajt %>%
filter(condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(accuracy = as.logical(accuracy)) %>%
group_by(study, group, task, participant) %>%
summarise(acc_rate = mean(accuracy, na.rm = T)) %>%
ungroup()
check <- temp %>%
group_by(study, group, task) %>%
summarise(n = n()) %>%
ungroup()
check <- temp %>%
filter(acc_rate <= .5)
ggplot(temp, aes(x=group, y=acc_rate, fill=group, label=participant)) +
geom_hline(yintercept=.5) +
geom_violin() +
geom_boxplot(width = .1, fill='white') +
theme_classic() +
scale_x_discrete(name="group",
limits = c('english', 'korean', 'mandarin'),
labels = c('ENS', 'KLE', 'MLE')) +
scale_y_continuous(name="accuracy rate",
limits=c(0, 1)) +
theme(text = element_text(size = 12),
plot.title = element_text(size = 12, hjust = .5),
legend.position = "hide") +
facet_wrap(~task)
ajt <- ajt %>%
left_join(temp, by = c('study', 'group', 'task', 'participant')) %>%
filter(acc_rate > .5)
plot <- ajt %>%
group_by(group, task, participant, acc_rate) %>%
summarise() %>%
ungroup()
ggplot(plot, aes(x=group, y=acc_rate, fill=group, label=participant)) +
geom_hline(yintercept=.5) +
geom_violin() +
geom_boxplot(width = .1, fill='white') +
theme_classic() +
scale_x_discrete(name="group",
limits = c('english', 'korean', 'mandarin'),
labels = c('ENS', 'KLE', 'MLE')) +
scale_y_continuous(name="accuracy rate",
limits=c(0, 1)) +
theme(text = element_text(size = 12),
plot.title = element_text(size = 12, hjust = .5),
legend.position = "hide") +
facet_wrap(~task)
check <- ajt %>%
group_by(study, task, group, participant) %>%
summarise() %>%
ungroup() %>%
group_by(study, task, group) %>%
summarise(n = n()) %>%
ungroup()
temp <- ajt %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'),
dependency = as.factor(dependency))
model1 <- read_rds('models/ajt_doenen_clmm_md1.rds')
summary(model1)
pairwise <- model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
pairwise
pairwise <- model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm') %>%
print()
kbl(summary(model1)$coefficients, digits = c(2, 2, 2, 3))
kbl(model1)
kbl(summary(model1))
summary(model1)
kbl(summary(model1)$Random_effects)
kbl(summary(model1)$Randomeffects)
model1 %>%
tidy() %>%
kable()
library(broom)
model1 %>%
tidy() %>%
kable()
model1 %>%
tidy() %>%
kbl())
model1 %>%
tidy() %>%
kbl()
model1 %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 3))
model1 %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 2, 3))
model1 %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 2, 3)) %>%
remove_column(6)
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
kbl(summary(model1)$Randomeffects)
model1 %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 2, 3)) %>%
remove_column(6)
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
pairwise %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 3)) %>%
remove_column(6)
pairwise %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 3))
pairwise %>%
tidy() %>%
kbl()
pairwise <- model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm') %>%
print()
pairwise %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 3)) %>%
remove_column(6)
pairwise %>%
tidy() %>%
kbl()
pairwise <- model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
pairwise %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 3)) %>%
remove_column(6)
pairwise %>%
tidy() %>%
kbl()
kbl(pairwise, digits = c(2, 2, 2, 3)) %>% remove_column(6)
pairwise %>%
kbl()
model1 %>%
tidy() %>%
kbl(digits = c(2, 2, 2, 2, 3)) %>%
remove_column(6)
