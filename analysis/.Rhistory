beep()
model5 <- read_rds('models/ajt_suenen_acc_md5.rds')
summary(model5)
anova(model3, model5)
model6 <- read_rds('models/ajt_suenen_acc_md6.rds')
anova(model3, model6)
model1 <- read_rds('models/ajt_suenen_acc_md1.rds')
summary(model1)
tic()
model1 <- glmer(acceptance ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, family = binomial,
control = glmerControl(optimizer = "bobyqa",
optCtrl=list(maxfun = 1e6))) %>%
write_rds('models/ajt_suenen_acc_md1.rds')
summary(model1)
toc()
beep()
29465/60
29465/(60*60)
model1 <- read_rds('models/ajt_suenen_acc_md1.rds')
summary(model1)
model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', by = 'environment') %>%
summary(by = NULL, adjust = 'holm')
model3 <- read_rds('models/ajt_suenen_acc_md3.rds')
anova(model1, model3)
anova(model1, model5)
anova(model1, model6)
temp <- ajt %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'),
dependency = as.factor(dependency))
md <- temp %>%
filter(study == '210510_do',
group == 'english',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
install.packages('ordinal')
View(md)
class(md$response)
md <- md %>%
mutate(response = as.factor(response))
class(md$response)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 | participant) +
(1 | item),
data = md) %>%
write_rds('models/ajt_doenen_clmm_md1.rds')
library(ordinal)
md <- temp %>%
filter(study == '210510_do',
group == 'english',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = as.factor(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 | participant) +
(1 | item),
data = md) %>%
write_rds('models/ajt_doenen_clmm_md1.rds')
summary(model1)
toc()
tic()
model6 <- clmm(response ~ dependency * environment +
(1 | participant) +
(1 | item),
data = md) %>%
write_rds('models/ajt_doenen_clmm_md6.rds')
summary(model6)
toc()
beep()
model6 <- read_rds('models/ajt_doenen_clmm_md6.rds')
summary(model6)
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', by = 'environment') %>%
summary(by = NULL, adjust = 'holm')
emmeans(model6, pairwise ~ dependency * environment, adjust = 'holm')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', by = c('environment', 'dependency')) %>%
summary(by = NULL, adjust = 'holm')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each') %>%
summary(by = NULL, adjust = 'holm')
emm <- emmeans(model6, ~ dependency * environment)
simp <- pairs(emm, simple = "each")
simp
summary(simp, adjust = 'holm')
model6 %>%
test(simp[[1]], by = NULL, adjust = "mvt")
emmeans(model6, pairwise ~ dependency * environment)
emmip(model6, dependency ~ environment)
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'mvt')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'bonferroni')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'tukey')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'sidak')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'mvt')
model6 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
tic()
model5 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 | item),
data = md) %>%
write_rds('models/ajt_doenen_clmm_md5.rds')
summary(model5)
toc()
beep()
model5 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', by = 'environment') %>%
summary(by = NULL, adjust = 'holm')
model5 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
tic()
model5 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 | item),
data = md)
toc()
summary(model5)
performance(model5)
model5b <- read_rds('models/ajt_doenen_acc_md5.rds')
performance(model5b)
tic()
model5 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_doenen_clmm_md5.rds')
summary(model5)
toc()
beep()
convergence(model5)
anova(model5, model6)
summary(model6)
summary(model5)
anova(model5, model6)
glance(model5)
library(broom)
glance(model5)
tic()
model6 <- clmm(response ~ dependency * environment + (1|participant) + (1|item), data = md)
toc()
summary(model6)
class(model6)
glance(model6)
emmip(model6, dependency ~ environment)
class(model5)
tic()
model5 <- clmm(reponse ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 | item),
data = md)
toc()
beep()
tic()
model5 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 | item),
data = md)
toc()
beep()
summary(model5)
class(model5)
class(model6)
convergence(model6)
convergence(model6)
performance(model5)
performance(model6)
tic()
model3 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_doenen_clmm_md3.rds')
summary(model3)
toc()
beep()
class(model3)
anova(model3, model6)
model3 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
807/60
tic()
model4 <- clmm(response ~ dependency * environment +
(1 + dependency + environment | participant) +
(1 + dependency + environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_doenen_clmm_md4.rds')
summary(model4)
toc()
beep()
class(model4)
anova(model3, model4)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_doenen_clmm_md1.rds')
summary(model1)
toc()
beep()
tic()
model2 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency + environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_doenen_clmm_md2.rds')
summary(model2)
toc()
beep()
anova(model1, model2)
anova(model1, model3)
anova(model2, model3)
model1 %>%
emmeans(~ dependency * environment) %>%
contrast('pairwise', simple = 'each', combine = TRUE) %>%
summary(by = NULL, adjust = 'holm')
nominal_test(model1)
install.packages("RVAideMemoire")
library(RVAideMemoire)
install.packages("car")
library(car)
install.packages("car")
Anova(model1, type="II")
library(RVAideMemoire)
library(car)
Anova(model1, type="II")
Anova.clmm(model1, type="II")
anova(model1, model2)
summary(model2)
model1 <- read_rds('models/ajt_doenen_clmm_md2.rds')
library(tidyverse) # for data processing
library(lmerTest) # for mixed-effects modeling
library(readxl) # for reading .xlsx files
library(base64enc) # for converting recordings from base64 to audio files
library(stringdist) # for calculating edit distance on c-test responses
library(hunspell) # for spell checking of c-test responses
library(patchwork) # for plotting
library(jsonlite) # for unpacking json
library(beepr) # for notifications
library(tictoc) # for timing operations
library(ggh4x) # for plotting
library(emmeans) #  for post-hoc tests; see https://marissabarlaz.github.io/portfolio/contrastcoding/
library(performance) # for checking model performance
df <- read_csv('data/data.csv', col_types = cols(.default = 'c')) %>%
select(-audio_data)
ct <- read_csv('data/ctest_scored.csv', col_types = cols(.default = 'f', accuracy = 'l'))
ajt <- df %>%
filter(task %in% c('english_ajt', 'korean_ajt', 'mandarin_ajt')) %>%
arrange(study, group, participant) %>%
select_if(function(x){!all(is.na(x))})
check <- ajt %>%
group_by(study, group, task, participant) %>%
summarise() %>%
ungroup() %>%
group_by(study, group, task) %>%
summarise(n = n()) %>%
ungroup()
check <- ajt %>%
filter(!response %in% c(1, 2, 3, 4, 5, 6))
ajt <- ajt %>%
filter(is.na(response) == FALSE)
ajt <- ajt %>%
mutate(acceptance = case_when(response > 3.5 ~ TRUE,
response < 3.5 ~ FALSE))
ajt <- ajt %>%
mutate(response = as.numeric(response)) %>%
group_by(study, group, task, participant) %>%
mutate(zscore = (response - mean(response, na.rm=T)) / sd(response, na.rm = T)) %>%
ungroup()
check <- ajt %>%
mutate(condition = as.factor(condition))
summary(check$condition)
temp <- ajt %>%
filter(condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(accuracy = as.logical(accuracy)) %>%
group_by(study, group, task, participant) %>%
summarise(acc_rate = mean(accuracy, na.rm = T)) %>%
ungroup()
check <- temp %>%
group_by(study, group, task) %>%
summarise(n = n()) %>%
ungroup()
check <- temp %>%
filter(acc_rate <= .5)
ggplot(temp, aes(x=group, y=acc_rate, fill=group, label=participant)) +
geom_hline(yintercept=.5) +
geom_violin() +
geom_boxplot(width = .1, fill='white') +
theme_classic() +
scale_x_discrete(name="group",
limits = c('english', 'korean', 'mandarin'),
labels = c('ENS', 'KLE', 'MLE')) +
scale_y_continuous(name="accuracy rate",
limits=c(0, 1)) +
theme(text = element_text(size = 12),
plot.title = element_text(size = 12, hjust = .5),
legend.position = "hide") +
facet_wrap(~task)
ajt <- ajt %>%
left_join(temp, by = c('study', 'group', 'task', 'participant')) %>%
filter(acc_rate > .5)
plot <- ajt %>%
group_by(group, task, participant, acc_rate) %>%
summarise() %>%
ungroup()
ggplot(plot, aes(x=group, y=acc_rate, fill=group, label=participant)) +
geom_hline(yintercept=.5) +
geom_violin() +
geom_boxplot(width = .1, fill='white') +
theme_classic() +
scale_x_discrete(name="group",
limits = c('english', 'korean', 'mandarin'),
labels = c('ENS', 'KLE', 'MLE')) +
scale_y_continuous(name="accuracy rate",
limits=c(0, 1)) +
theme(text = element_text(size = 12),
plot.title = element_text(size = 12, hjust = .5),
legend.position = "hide") +
facet_wrap(~task)
check <- ajt %>%
group_by(study, task, group, participant) %>%
summarise() %>%
ungroup() %>%
group_by(study, task, group) %>%
summarise(n = n()) %>%
ungroup()
temp <- ajt %>%
filter(!condition %in% c('grammatical', 'ungrammatical')) %>%
mutate(environment = fct_relevel(environment, 'short', 'long', 'island'),
dependency = as.factor(dependency))
library(ordinal)
md <- temp %>%
filter(study == '210510_do',
group == 'english',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = as.factor(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
model1 <- read_rds('models/ajt_doenen_clmm_md1.rds')
summary(model1)
library(RVAideMemoire)
library(car)
Anova(model1, type="II")
Anova.clmm(model1, type="II")
md <- temp %>%
filter(study == '210510_do',
group == 'korean',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = as.factor(response, ordered = TRUE))
md$response
summary(md$response)
class(md$response)
md <- md %>%
mutate(response = as.factor(response))
class(md$response)
summary(md$response)
md <- md %>%
mutate(response = ordered(response))
class(md$response)
summary(md$response)
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_dokoen_clmm_md1.rds')
summary(model1)
toc()
beep()
md <- temp %>%
filter(study == '210510_do',
group == 'mandarin',
task == 'english_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6)) %>%
write_rds('models/ajt_dozhen_clmm_md1.rds')
summary(model1)
toc()
beep()
md <- temp %>%
filter(study == '210510_do',
group == 'korean',
task == 'korean_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dokoko_clmm_md1.rds')
summary(model1)
toc()
beep()
md <- temp %>%
filter(study == '210510_do',
group == 'mandarin',
task == 'mandarin_ajt')
check <- md %>%
group_by(study, group, participant) %>%
summarise() %>%
ungroup()
md <- md %>%
mutate(response = ordered(response))
contrasts(md$dependency) <- contr.treatment(2) - matrix(rep(1/2, 2), ncol=1)
contrasts(md$environment) <- contr.treatment(3) - matrix(rep(1/3, 6), ncol=2)
contrasts(md$dependency)
contrasts(md$environment)
tic()
model1 <- clmm(response ~ dependency * environment +
(1 + dependency * environment | participant) +
(1 + dependency * environment | item),
data = md, control=clmm.control(grtol=1e6), Hess = TRUE) %>%
write_rds('models/ajt_dozhzh_clmm_md1.rds')
summary(model1)
toc()
beep()
3246.32/60
5593.59
5593.59/60
